<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>K_nearest_neighbors_examples</title>
<style type="text/css">
/**
 * Prism.s theme ported from highlight.js's xcode style
 */
pre code {
  padding: 1em;
}
.token.comment {
  color: #007400;
}
.token.punctuation {
  color: #999;
}
.token.tag,
.token.selector {
  color: #aa0d91;
}
.token.boolean,
.token.number,
.token.constant,
.token.symbol {
  color: #1c00cf;
}
.token.property,
.token.attr-name,
.token.string,
.token.char,
.token.builtin {
  color: #c41a16;
}
.token.inserted {
  background-color: #ccffd8;
}
.token.deleted {
  background-color: #ffebe9;
}
.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: #9a6e3a;
}
.token.atrule,
.token.attr-value,
.token.keyword {
  color: #836c28;
}
.token.function,
.token.class-name {
  color: #DD4A68;
}
.token.regex,
.token.important,
.token.variable {
  color: #5c2699;
}
.token.important,
.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}
</style>
<style type="text/css">
body {
  font-family: sans-serif;
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 1.5;
  box-sizing: border-box;
}
body, .footnotes, code { font-size: .9em; }
li li { font-size: .95em; }
*, *:before, *:after {
  box-sizing: inherit;
}
pre, img { max-width: 100%; }
pre, pre:hover {
  white-space: pre-wrap;
  word-break: break-all;
}
pre code {
  display: block;
  overflow-x: auto;
}
code { font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace; }
:not(pre) > code, code[class] { background-color: #F8F8F8; }
code.language-undefined, pre > code:not([class]) {
  background-color: inherit;
  border: 1px solid #eee;
}
table {
  margin: auto;
  border-top: 1px solid #666;
}
table thead th { border-bottom: 1px solid #ddd; }
th, td { padding: 5px; }
thead, tfoot, tr:nth-child(even) { background: #eee; }
blockquote {
  color: #666;
  margin: 0;
  padding-left: 1em;
  border-left: 0.5em solid #eee;
}
hr, .footnotes::before { border: 1px dashed #ddd; }
.frontmatter { text-align: center; }
#TOC .numbered li { list-style: none; }
#TOC .numbered { padding-left: 0; }
#TOC .numbered ul { padding-left: 1em; }
table, .body h2 { border-bottom: 1px solid #666; }
.body .appendix, .appendix ~ h2 { border-bottom-style: dashed; }
.footnote-ref a::before { content: "["; }
.footnote-ref a::after { content: "]"; }
section.footnotes::before {
  content: "";
  display: block;
  max-width: 20em;
}

@media print {
  body {
    font-size: 12pt;
    max-width: 100%;
  }
  tr, img { page-break-inside: avoid; }
}
@media only screen and (min-width: 992px) {
  pre { white-space: pre; }
}
</style>
</head>
<body>
<div class="frontmatter">
<div class="title"><h1>K_nearest_neighbors_examples</h1></div>
<div class="author"><h2>Raymaekers, J. and Rousseeuw, P.J.</h2></div>
<div class="date"><h3>2025-05-13</h3></div>
</div>
<div class="body">
<h1 id="introduction">Introduction</h1>
<p>This vignette visualizes classification results from k-nearest neighbors, using tools from the package.</p>
<pre><code class="language-r">library(&quot;classmap&quot;)
</code></pre>
<h1 id="iris-data">Iris data</h1>
<p>As a first small example, we consider the Iris data.
We first load the data and inspect it. We also scale the data, to make the results of the k-nearest neighbor classifier scale-invariant.</p>
<pre><code class="language-r">data(iris)
X &lt;- iris[, 1:4]
y &lt;- iris[, 5]
is.factor(y) 
</code></pre>
<pre><code>## [1] TRUE
</code></pre>
<pre><code class="language-r">table(y) 
</code></pre>
<pre><code>## y
##     setosa versicolor  virginica 
##         50         50         50
</code></pre>
<pre><code class="language-r">X &lt;- scale(X) # if you want to scale, best to do it yourself.
pairs(X, col = as.numeric(y) + 1, pch = 19)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"  />
<p class="caption">plot of chunk unnamed-chunk-3</p>
</div>
<pre><code class="language-r">dis &lt;- dist(X, method = &quot;euclidean&quot;)
</code></pre>
<p>The VCR object for the k-nearest neighbors classifier can be constructed based on a distance matrix or the original data. We use k = 5 here:</p>
<pre><code class="language-r">vcr.train &lt;- vcr.knn.train(dis, y, k = 5)

vcr.train &lt;- vcr.knn.train(X, y, k = 5) # Gives the same result.
</code></pre>
<p>Let’s inspect some of the elements in the output of the vcr.train function;
We first look at the prediction as integer, prediction as label, the
alternative label as integer and the alternative label.</p>
<pre><code class="language-r">names(vcr.train)
</code></pre>
<pre><code>##  [1] &quot;yint&quot;      &quot;y&quot;         &quot;levels&quot;    &quot;predint&quot;   &quot;pred&quot;      &quot;altint&quot;   
##  [7] &quot;altlab&quot;    &quot;PAC&quot;       &quot;figparams&quot; &quot;fig&quot;       &quot;farness&quot;   &quot;ofarness&quot; 
## [13] &quot;k&quot;         &quot;ktrues&quot;    &quot;counts&quot;    &quot;X&quot;
</code></pre>
<pre><code class="language-r">vcr.train$predint 
</code></pre>
<pre><code>##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2
##  [75] 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 2 3 3 3 3
## [112] 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3
## [149] 3 3
</code></pre>
<pre><code class="language-r">vcr.train$pred[c(1:10, 51:60, 101:110)]
</code></pre>
<pre><code>##  [1] &quot;setosa&quot;     &quot;setosa&quot;     &quot;setosa&quot;     &quot;setosa&quot;     &quot;setosa&quot;    
##  [6] &quot;setosa&quot;     &quot;setosa&quot;     &quot;setosa&quot;     &quot;setosa&quot;     &quot;setosa&quot;    
## [11] &quot;versicolor&quot; &quot;versicolor&quot; &quot;versicolor&quot; &quot;versicolor&quot; &quot;versicolor&quot;
## [16] &quot;versicolor&quot; &quot;versicolor&quot; &quot;versicolor&quot; &quot;versicolor&quot; &quot;versicolor&quot;
## [21] &quot;virginica&quot;  &quot;virginica&quot;  &quot;virginica&quot;  &quot;virginica&quot;  &quot;virginica&quot; 
## [26] &quot;virginica&quot;  &quot;versicolor&quot; &quot;virginica&quot;  &quot;virginica&quot;  &quot;virginica&quot;
</code></pre>
<pre><code class="language-r">vcr.train$altint  
</code></pre>
<pre><code>##   [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
##  [26] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA  2 NA NA NA NA NA NA NA NA
##  [51] NA NA NA NA  3 NA  3 NA NA NA NA NA NA  3 NA NA NA NA  3 NA  3 NA  3 NA NA
##  [76] NA NA  3 NA NA NA NA NA  3 NA NA NA  3 NA NA NA NA NA NA NA NA NA NA NA NA
## [101] NA  2 NA NA NA NA  2 NA  2 NA NA NA NA  2 NA NA  2 NA NA  2 NA NA NA  2 NA
## [126] NA  2  2 NA  2 NA NA NA  2  2 NA NA  2  2 NA NA NA  2 NA NA NA  2 NA NA  2
</code></pre>
<p>The NA’s stem from k-neighborhoods in which all members are from the given class. In such cases there is no alternative class.</p>
<pre><code class="language-r">vcr.train$altlab  # has NA's for the same cases:
</code></pre>
<pre><code>##   [1] NA           NA           NA           NA           NA          
##   [6] NA           NA           NA           NA           NA          
##  [11] NA           NA           NA           NA           NA          
##  [16] NA           NA           NA           NA           NA          
##  [21] NA           NA           NA           NA           NA          
##  [26] NA           NA           NA           NA           NA          
##  [31] NA           NA           NA           NA           NA          
##  [36] NA           NA           NA           NA           NA          
##  [41] NA           &quot;versicolor&quot; NA           NA           NA          
##  [46] NA           NA           NA           NA           NA          
##  [51] NA           NA           NA           NA           &quot;virginica&quot; 
##  [56] NA           &quot;virginica&quot;  NA           NA           NA          
##  [61] NA           NA           NA           &quot;virginica&quot;  NA          
##  [66] NA           NA           NA           &quot;virginica&quot;  NA          
##  [71] &quot;virginica&quot;  NA           &quot;virginica&quot;  NA           NA          
##  [76] NA           NA           &quot;virginica&quot;  NA           NA          
##  [81] NA           NA           NA           &quot;virginica&quot;  NA          
##  [86] NA           NA           &quot;virginica&quot;  NA           NA          
##  [91] NA           NA           NA           NA           NA          
##  [96] NA           NA           NA           NA           NA          
## [101] NA           &quot;versicolor&quot; NA           NA           NA          
## [106] NA           &quot;versicolor&quot; NA           &quot;versicolor&quot; NA          
## [111] NA           NA           NA           &quot;versicolor&quot; NA          
## [116] NA           &quot;versicolor&quot; NA           NA           &quot;versicolor&quot;
## [121] NA           NA           NA           &quot;versicolor&quot; NA          
## [126] NA           &quot;versicolor&quot; &quot;versicolor&quot; NA           &quot;versicolor&quot;
## [131] NA           NA           NA           &quot;versicolor&quot; &quot;versicolor&quot;
## [136] NA           NA           &quot;versicolor&quot; &quot;versicolor&quot; NA          
## [141] NA           NA           &quot;versicolor&quot; NA           NA          
## [146] NA           &quot;versicolor&quot; NA           NA           &quot;versicolor&quot;
</code></pre>
<p>The output also contains the value of k, which was an input value, as well as the “true” value of k used for each instance, which can differ from the input value of k in case of ties:</p>
<pre><code class="language-r">vcr.train$k 
</code></pre>
<pre><code>## [1] 5
</code></pre>
<pre><code class="language-r">vcr.train$ktrues[1:10]
</code></pre>
<pre><code>##  [1] 6 5 5 6 5 5 5 5 5 5
</code></pre>
<p>We can also extract the probability of Alternative Class (PAC) of each object, which we will use later to construct the class map:</p>
<pre><code class="language-r">vcr.train$PAC # length 150, all between 0 and 1, no NA's
</code></pre>
<pre><code>##   [1] 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
##  [19] 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
##  [37] 0.0 0.0 0.0 0.0 0.0 0.4 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
##  [55] 0.2 0.0 0.2 0.0 0.0 0.0 0.0 0.0 0.0 0.2 0.0 0.0 0.0 0.0 0.4 0.0 0.6 0.0
##  [73] 0.6 0.0 0.0 0.0 0.0 0.6 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.2 0.0 0.0
##  [91] 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.2 0.0 0.0 0.0 0.0 0.8 0.0
## [109] 0.2 0.0 0.0 0.0 0.0 0.2 0.0 0.0 0.2 0.0 0.0 1.0 0.0 0.0 0.0 0.2 0.0 0.0
## [127] 0.2 0.2 0.0 0.2 0.0 0.0 0.0 0.6 0.6 0.0 0.0 0.2 0.4 0.0 0.0 0.0 0.2 0.0
## [145] 0.0 0.0 0.4 0.0 0.0 0.4
</code></pre>
<p>The second ingredient of the class map is the farness, which is computed from the fig values defined as f(i, g)= the distance from case i to class g:</p>
<pre><code class="language-r">vcr.train$fig[1:5, ]
</code></pre>
<pre><code>##            [,1]      [,2]      [,3]
## [1,] 0.04461133 0.9996704 0.9986414
## [2,] 0.03342043 0.9990550 0.9984272
## [3,] 0.31360938 0.9996165 0.9986936
## [4,] 0.24999968 0.9994512 0.9986348
## [5,] 0.26756761 0.9997711 0.9988206
</code></pre>
<p>The farness of an object i is the f(i, g) to its own class:</p>
<pre><code class="language-r">vcr.train$farness[1:5]
</code></pre>
<pre><code>## [1] 0.04461133 0.03342043 0.31360938 0.24999968 0.26756761
</code></pre>
<pre><code class="language-r">summary(vcr.train$farness)
</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.01647 0.25000 0.50000 0.50560 0.76622 0.99669
</code></pre>
<p>The “overall farness” of an object is defined as the  lowest f(i, g) it has to any class g (including its own). This always exists.</p>
<pre><code class="language-r">summary(vcr.train$ofarness)
</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.01647 0.25000 0.49745 0.49660 0.74040 0.99669
</code></pre>
<p>Using confmat.vcr(), we can construct the usual confusion matrix and obtain the accuracy of the classification:</p>
<pre><code class="language-r">confmat.vcr(vcr.train, showOutliers = FALSE)
</code></pre>
<pre><code>## 
## Confusion matrix:
##             predicted
## given        setosa versicolor virginica
##   setosa         50          0         0
##   versicolor      0         46         4
##   virginica       0          4        46
## 
## The accuracy is 94.67%.
</code></pre>
<p>By using showOutliers = TRUE and setting a cutoff, objects with ofarness &gt; cutoff are flagged as outliers and shown in a separate column of the confusion matrix:</p>
<pre><code class="language-r">confmat.vcr(vcr.train, cutoff = 0.98)
</code></pre>
<pre><code>## 
## Confusion matrix:
##             predicted
## given        setosa versicolor virginica outl
##   setosa         49          0         0    1
##   versicolor      0         46         4    0
##   virginica       0          4        44    2
## 
## The accuracy is 94.67%.
</code></pre>
<p>With the default cutoff = 0.99 only one object is flagged in this example:</p>
<pre><code class="language-r">confmat.vcr(vcr.train)
</code></pre>
<pre><code>## 
## Confusion matrix:
##             predicted
## given        setosa versicolor virginica outl
##   setosa         49          0         0    1
##   versicolor      0         46         4    0
##   virginica       0          4        46    0
## 
## The accuracy is 94.67%.
</code></pre>
<p>Note that the accuracy is computed before any objects are flagged, so it does not depend on the cutoff. Finally, we can also show the class numbers instead of the labels in the confusion matrix. This option can be useful for long level
names.</p>
<pre><code class="language-r">confmat.vcr(vcr.train, showClassNumbers = TRUE)
</code></pre>
<pre><code>## 
## Confusion matrix:
##      predicted
## given  1  2  3 outl
##     1 49  0  0    1
##     2  0 46  4    0
##     3  0  4 46    0
## 
## The accuracy is 94.67%.
</code></pre>
<p>The stacked mosaic plot is a graphical representation of the confusion matrix, and can be made using the stackedplot() function. The outliers can optionally be shown as separate gray areas on top of each rectangle:</p>
<pre><code class="language-r">par(mfrow = c(1, 1))
cols &lt;- c(&quot;red&quot;, &quot;darkgreen&quot;, &quot;blue&quot;)
stackedplot(vcr.train, classCols = cols, separSize = 1.5,
            minSize = 1, showOutliers = FALSE, showLegend = TRUE,
            main = &quot;Stacked plot of kNN on iris data&quot;)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"  />
<p class="caption">plot of chunk unnamed-chunk-16</p>
</div>
<pre><code class="language-r">stackedplot(vcr.train, classCols = cols, separSize = 1.5,
            minSize = 1, showLegend = TRUE,
            main = &quot;Stacked plot of kNN on iris data&quot;)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"  />
<p class="caption">plot of chunk unnamed-chunk-16</p>
</div>
<pre><code class="language-r">par(oldpar)
</code></pre>
<p>By default, no legend is added to the stacked mosaic plot, because we see the colors at the bottom of each given class anyway:</p>
<pre><code class="language-r">stplot &lt;- stackedplot(vcr.train, classCols = cols, 
                      separSize = 1.5, minSize = 1,
                      main = &quot;Stacked plot of kNN on iris data&quot;)
stplot 
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-17"  />
<p class="caption">plot of chunk unnamed-chunk-17</p>
</div>
<p>We now construct the silhouette plot:</p>
<pre><code class="language-r"># pdf(&quot;Iris_kNN_silhouettes.pdf&quot;, width=5.0, height=4.6)
silplot(vcr.train, classCols = cols, 
        main = &quot;Silhouette plot of kNN on iris data&quot;)      
</code></pre>
<pre><code>##  classNumber classLabel classSize classAveSi
##            1     setosa        50       0.98
##            2 versicolor        50       0.84
##            3  virginica        50       0.75
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-18"  />
<p class="caption">plot of chunk unnamed-chunk-18</p>
</div>
<pre><code class="language-r"># dev.off()
</code></pre>
<p>Now we turn to the construction of the class maps.</p>
<p>For class 1, only one point has PAC &gt; 0, around 0.4.
All the others are classified perfectly:</p>
<pre><code class="language-r">classmap(vcr.train, 1, classCols = cols)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-19"  />
<p class="caption">plot of chunk unnamed-chunk-19</p>
</div>
<p>Class 2 shows only 4 points with PAC &gt; 0.5:</p>
<pre><code class="language-r">classmap(vcr.train, 2, classCols = cols)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-20"  />
<p class="caption">plot of chunk unnamed-chunk-20</p>
</div>
<p>Finally, class 3 also has 4 points with PAC &gt; 0.5:</p>
<pre><code class="language-r">classmap(vcr.train, 3, classCols = cols)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-21"  />
<p class="caption">plot of chunk unnamed-chunk-21</p>
</div>
<hr />
<p>To illustrate the use of new data we create a `fake’ dataset which is a subset of training data, where not all classes occur, and ynew has NA’s.
First create and inspect this test data:</p>
<pre><code class="language-r">Xnew &lt;- X[c(1:50, 101:150),]
ynew &lt;- y[c(1:50, 101:150)]
ynew[c(1:10, 51:60)] &lt;- NA
pairs(X, col = as.numeric(y) + 1, pch = 19) # 3 colors
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-22"  />
<p class="caption">plot of chunk unnamed-chunk-22</p>
</div>
<pre><code class="language-r">pairs(Xnew, col = as.numeric(ynew) + 1, pch = 19) # only red and blue
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-22"  />
<p class="caption">plot of chunk unnamed-chunk-22</p>
</div>
<p>Now build the VCR object on the new data, using the output vcr.train which was built on the training data.</p>
<pre><code class="language-r">vcr.test &lt;- vcr.knn.newdata(Xnew, ynew, vcr.train, LOO = TRUE)
</code></pre>
<p>We perform a few sanity checks by comparing the vcr object of the training data with that of the test data. Note that the following only match when LOO = TRUE since we use “leave-one-out” in training! The default is LOO = FALSE.</p>
<pre><code class="language-r">plot(vcr.test$predint, vcr.train$predint[c(1:50, 101:150)]); abline(0, 1)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-24"  />
<p class="caption">plot of chunk unnamed-chunk-24</p>
</div>
<pre><code class="language-r">plot(vcr.test$altint, vcr.train$altint[c(1:50, 101:150)]); abline(0, 1)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-24"  />
<p class="caption">plot of chunk unnamed-chunk-24</p>
</div>
<pre><code class="language-r">plot(vcr.test$PAC, vcr.train$PAC[c(1:50, 101:150)]); abline(0, 1) 
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-24"  />
<p class="caption">plot of chunk unnamed-chunk-24</p>
</div>
<pre><code class="language-r">vcr.test$farness 
</code></pre>
<pre><code>##   [1]         NA         NA         NA         NA         NA         NA
##   [7]         NA         NA         NA         NA 0.73247121 0.36589548
##  [13] 0.24999968 0.79924753 0.87396416 0.97491095 0.79924753 0.04461133
##  [19] 0.79924753 0.24610411 0.52074700 0.54514841 0.82815149 0.75324677
##  [25] 0.64247009 0.36138149 0.36138149 0.15373845 0.19064246 0.22847962
##  [31] 0.19064246 0.62411021 0.90504454 0.87228426 0.15373845 0.49806452
##  [37] 0.62411021 0.59563405 0.54175612 0.15373845 0.26756761 0.99669277
##  [43] 0.56908070 0.70411547 0.45330349 0.33045955 0.50193548 0.15373845
##  [49] 0.55447868 0.24999968         NA         NA         NA         NA
##  [55]         NA         NA         NA         NA         NA         NA
##  [61] 0.31224622 0.29161308 0.17210482 0.79288558 0.78742650 0.50317237
##  [67] 0.01647377 0.98448662 0.92264168 0.93153659 0.08394010 0.65348271
##  [73] 0.69542454 0.33736954 0.42034585 0.76741891 0.29161308 0.36680188
##  [79] 0.34391108 0.76263566 0.73701673 0.98482904 0.40090355 0.54448626
##  [85] 0.86070226 0.84818064 0.50317237 0.20998164 0.49682763 0.08394010
##  [91] 0.04045957 0.09945973 0.42645401 0.07996972 0.37628241 0.02454008
##  [97] 0.76862586 0.17210482 0.50549224 0.68050661
</code></pre>
<pre><code class="language-r">plot(vcr.test$farness, vcr.train$farness[c(1:50, 101:150)]); abline(0, 1)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-24"  />
<p class="caption">plot of chunk unnamed-chunk-24</p>
</div>
<pre><code class="language-r">plot(vcr.test$fig, vcr.train$fig[c(1:50, 101:150), ]); abline(0, 1)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-24"  />
<p class="caption">plot of chunk unnamed-chunk-24</p>
</div>
<pre><code class="language-r">vcr.test$ofarness  # This does exist for every case, even if is given label is NA:
</code></pre>
<pre><code>##   [1] 0.04461133 0.03342043 0.31360938 0.24999968 0.26756761 0.73406966
##   [7] 0.77153198 0.19064246 0.81769352 0.24999968 0.73247121 0.36589548
##  [13] 0.24999968 0.79924753 0.87396416 0.97491095 0.79924753 0.04461133
##  [19] 0.79924753 0.24610411 0.52074700 0.54514841 0.82815149 0.75324677
##  [25] 0.64247009 0.36138149 0.36138149 0.15373845 0.19064246 0.22847962
##  [31] 0.19064246 0.62411021 0.90504454 0.87228426 0.15373845 0.49806452
##  [37] 0.62411021 0.59563405 0.54175612 0.15373845 0.26756761 0.99669277
##  [43] 0.56908070 0.70411547 0.45330349 0.33045955 0.50193548 0.15373845
##  [49] 0.55447868 0.24999968 0.47804488 0.42645401 0.60529406 0.36680188
##  [55] 0.22408548 0.68239080 0.96393539 0.60529406 0.87814119 0.93697386
##  [61] 0.31224622 0.29161308 0.17210482 0.79288558 0.78742650 0.50317237
##  [67] 0.01647377 0.98448662 0.92264168 0.92252602 0.08394010 0.65348271
##  [73] 0.69542454 0.33736954 0.42034585 0.76741891 0.29161308 0.36680188
##  [79] 0.34391108 0.76263566 0.73701673 0.98482904 0.40090355 0.54448626
##  [85] 0.86070226 0.84818064 0.50317237 0.20998164 0.49682763 0.08394010
##  [91] 0.04045957 0.09945973 0.42645401 0.07996972 0.37628241 0.02454008
##  [97] 0.76862586 0.17210482 0.50549224 0.68050661
</code></pre>
<pre><code class="language-r">plot(vcr.test$ofarness, vcr.train$ofarness[c(1:50, 101:150)]); abline(0, 1)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-24"  />
<p class="caption">plot of chunk unnamed-chunk-24</p>
</div>
<p>We now construct and inspect the confusion matrix and the stacked mosaic plot. We plot the mosaic plot on the training data again, for comparison:</p>
<pre><code class="language-r">confmat.vcr(vcr.test) 
</code></pre>
<pre><code>## 
## Confusion matrix:
##            predicted
## given       setosa versicolor virginica outl
##   setosa        39          0         0    1
##   virginica      0          3        37    0
## 
## The accuracy is 96.25%.
</code></pre>
<pre><code class="language-r">stplot 
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-25"  />
<p class="caption">plot of chunk unnamed-chunk-25</p>
</div>
<pre><code class="language-r">stackedplot(vcr.test, classCols = cols, separSize = 1.5, minSize = 1, main = &quot;Stacked plot of kNN on iris subset&quot;) 
</code></pre>
<pre><code>## 
## Not all classes occur in these data. The classes to plot are:
## [1] 1 3
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-25"  />
<p class="caption">plot of chunk unnamed-chunk-25</p>
</div>
<p>And we also make the silhouette plot on the test data:</p>
<pre><code class="language-r"># pdf(&quot;Iris_test_kNN_silhouettes.pdf&quot;, width=5.0, height=4.6)
silplot(vcr.test, classCols = cols, 
        main = &quot;Silhouette plot of kNN on iris subset&quot;)      
</code></pre>
<pre><code>##  classNumber classLabel classSize classAveSi
##            1     setosa        40       0.98
##            3  virginica        40       0.75
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-26"  />
<p class="caption">plot of chunk unnamed-chunk-26</p>
</div>
<pre><code class="language-r"># dev.off()
</code></pre>
<p>For each class, we now make the class map on the test data,
and compare with the class map on the training data.
First for class 1:</p>
<pre><code class="language-r">classmap(vcr.train, 1, classCols = cols)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-27"  />
<p class="caption">plot of chunk unnamed-chunk-27</p>
</div>
<pre><code class="language-r">classmap(vcr.test, 1, classCols = cols) 
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-27"  />
<p class="caption">plot of chunk unnamed-chunk-27</p>
</div>
<p>Now for class 2. This throws an error on the test data, as there are no observations with the label versicolor in the test data.</p>
<pre><code class="language-r">classmap(vcr.train, 2, classCols = cols)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-28"  />
<p class="caption">plot of chunk unnamed-chunk-28</p>
</div>
<pre><code class="language-r">classmap(vcr.test, 2, classCols = cols)
</code></pre>
<pre><code>## Error in classmap(vcr.test, 2, classCols = cols): Class number 2 with label versicolor has no objects to visualize.
</code></pre>
<pre><code class="language-r"># Class number 2 with label versicolor has no objects to visualize.
</code></pre>
<p>Finally for class 3. It looks the same as the class map for the training data, but there are fewer points:</p>
<pre><code class="language-r">classmap(vcr.train, 3, classCols = cols)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-29"  />
<p class="caption">plot of chunk unnamed-chunk-29</p>
</div>
<pre><code class="language-r">classmap(vcr.test, 3, classCols = cols) # same, but fewer points
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-29"  />
<p class="caption">plot of chunk unnamed-chunk-29</p>
</div>
***
<h1 id="spam-data">Spam data</h1>
<p>In the example we analyze the spam data. It can be obtained via the kernlab package. It contains 4601 emails, 57 variables and a categorical variable indicating whether an email is nonspam or spam:</p>
<pre><code class="language-r">library(kernlab)
</code></pre>
<pre><code>## Warning: package 'kernlab' was built under R version 4.4.1
</code></pre>
<pre><code>## 
## Attaching package: 'kernlab'
</code></pre>
<pre><code>## The following object is masked from 'package:ggplot2':
## 
##     alpha
</code></pre>
<pre><code class="language-r">#?kernlab::spam 
data(spam)
</code></pre>
<p>We now create a matrix of predictors and a response vector. Inspection shows that the predictors contain 394 duplicate rows:</p>
<pre><code class="language-r">y &lt;- spam$type
table(y)
</code></pre>
<pre><code>## y
## nonspam    spam 
##    2788    1813
</code></pre>
<pre><code class="language-r">X &lt;- spam[, -58] 
sum(duplicated(X))
</code></pre>
<pre><code>## [1] 394
</code></pre>
<p>Now we can construct the vcr object based on the k-nearest neighbor classifier. All knn computations will be done on scale(X), but we  keep the original data X for interpreting the results.</p>
<pre><code class="language-r">vcr.obj &lt;- vcr.knn.train(scale(X), y, k = 5) 
names(vcr.obj) 
</code></pre>
<pre><code>##  [1] &quot;yint&quot;      &quot;y&quot;         &quot;levels&quot;    &quot;predint&quot;   &quot;pred&quot;      &quot;altint&quot;   
##  [7] &quot;altlab&quot;    &quot;PAC&quot;       &quot;figparams&quot; &quot;fig&quot;       &quot;farness&quot;   &quot;ofarness&quot; 
## [13] &quot;k&quot;         &quot;ktrues&quot;    &quot;counts&quot;    &quot;X&quot;
</code></pre>
<pre><code class="language-r">vcr.obj$predint[1:100]; length(vcr.obj$predint) 
</code></pre>
<pre><code>##   [1] 2 2 2 2 2 2 2 2 2 2 2 1 2 2 2 1 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 2
##  [38] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 2 2 1 1 2 1 2 2 2 2 2 2 2 2 2 2
##  [75] 2 2 1 2 2 2 2 1 2 2 1 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2
</code></pre>
<pre><code>## [1] 4601
</code></pre>
<pre><code class="language-r">vcr.obj$altint[1:100]
</code></pre>
<pre><code>##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
</code></pre>
<pre><code class="language-r">vcr.obj$k 
</code></pre>
<pre><code>## [1] 5
</code></pre>
<pre><code class="language-r">summary(vcr.obj$ktrues) 
</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   5.000   5.000   5.000   6.453   5.000  73.000
</code></pre>
<p>We now inspect the confusion matrices, with and without the outliers in a separate column:</p>
<pre><code class="language-r">confmat.vcr(vcr.obj, showOutliers = FALSE)
</code></pre>
<pre><code>## 
## Confusion matrix:
##          predicted
## given     nonspam spam
##   nonspam    2607  181
##   spam        228 1585
## 
## The accuracy is 91.11%.
</code></pre>
<pre><code class="language-r">confmat.vcr(vcr.obj)
</code></pre>
<pre><code>## 
## Confusion matrix:
##          predicted
## given     nonspam spam outl
##   nonspam    2548  172   68
##   spam        221 1563   29
## 
## The accuracy is 91.11%.
</code></pre>
<p>Now construct the stacked mosaic plot. The nonspam emails get the blue color, whereas the spam class is shown in red:</p>
<pre><code class="language-r">cols &lt;- c(&quot;deepskyblue2&quot;, &quot;red&quot;) 
# nonspam is blue, spam is red

stackedplot(vcr.obj, separSize = 1.5, minSize = 1,
            classCols = cols, showOutliers = FALSE,
            main = &quot;Spam data&quot;)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-34"  />
<p class="caption">plot of chunk unnamed-chunk-34</p>
</div>
<pre><code class="language-r">stackedplot(vcr.obj, separSize = 1.5, minSize = 2,
            classCols = cols, main = &quot;Spam data&quot;)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAD8CAMAAABtu84GAAAA8FBMVEUAAAAAADoAAGYAOpAAZmYAZrYAsu4zMzM6AAA6ADo6AGY6OmY6OpA6ZmY6ZrY6kJA6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOmZmOpBmZgBmZmZmkJBmtttmtv9uTU1ubm5ujo5ujshuq+SOTU2Ojo6OyP+QOgCQOjqQOmaQkDqQkGaQ2/+rbk2r5P+2ZgC2Zjq2kDq2/7a2///Ijk3Ijm7IyI7I///bkDrbtmbb25Db/7bb/9vb///kq27k5P/k///r6+v/AAD/tmb/yI7/25D/5Kv/5OT//7b//8j//9v//+T////viSywAAAACXBIWXMAAAsSAAALEgHS3X78AAAHBElEQVR4nO3dj3vaRBzH8RSGtrP+AKe0zqmZWi1T49ChjnWjTlNmZPn//xvvLpcW1tJhy31ytO/P8wwC4WHX1747vhwpSUoiSdL0AG5LgBYFaFGAFgVoUYAWJW7o2SBJks4KDyz2stBjuWbihh52LPYK0mfQ07ujkCO6cqKGrvhWoQP6Wjkt5tmjn9wUkruZZDb4cjvpTLfrScXce8dAu51FP9nym82N+6JEDV0aNgc2G7RGRb9b9NMy38pmg/ak6Lcn052selBajrcyv9NWtN9sdOhvJm7o0lnbGk7Lcuxq1EwS9lb9xyRvT+qpw1zVU0dsL4/RQ5tZd8fRWlAzXSRbb0KPPXS100FXmw2PezFRQ+ctW53G01e0nSuWVrTfaaH9ZrODfyNRQ9vJ2FVsNSunFn54rqL9HO13WmS/2fDoFxM1tGmkTftgsGeDL5Kk696/fFTV9xy0nSg+tHXudyap32x47IuJHNpnFpnaFQK0KECLshnQNyBAiwK0KECLcjH0X2R9AVqUFaCv/f/l1gdoUVaCFo7nxgZoUVaGfnejI/NcGipaFKBFAVqUWwT9TmOxf/vK0H9vdIAWBWhRgBYFaFGAFgVoUTYIevMDtChAiwK0KBsC3dww1xGgRQFaFKBFAVoUoEUBWpQLfzZpgBYFaFGAFuUWQTe7SAs00OsM0KIALQrQogAtSpzQuf3ipxTo0NCzR9m4M92dAB0YutgfDbvmAujA0LMfnuxlVHR46DJP2s/rL3wCOiD0fIAOCE3XoYGm6xBB03WIoOk6RNB0HSro+QAdEHqcmLSYo0NDF3vZMM07VHRw6P3RmK5DAG36aPOWBejg0GXefjFIukwdwaHpOhTQ9vQQdB0CaCpaB52fntgE6JDQpusoS9Y6wkO7zo72Ljx0fU4ZoANDu8bDNx1Ah4SeD9BA/58ALQrQokQIzVtwEbTJ0LZ3LPwHh+YNiwiaNywiaDdNe2egQ0LTdYigTUV/ZVfwgA4LbeboYcoyaXhoe5BjStcRHtpVNF1HeGiWSVXQ8wE6HDTvDCXQ9pTlSXL6jgXoUNBnxQx0YGiO6xBBc1yHCJoXQxE0y6QiaN6wqKDnA3Qo6GL/SZ8PZwXQVLQImsMNRNAlhxuooOmjRdD00SJoDjdQQdN1iKA53EADzeEGImgONxBBc7iBCJrVOxE0nxkCfeVECe3WOoAOD12wHq2BXgjQAaFZ69BAs3ongmY9WgRdDrt8wqKAXvjUEOhw0HQdQF85QIsCtCgRQtcvhbwYhoau1+6qDaBDQTN1yKD95LGVAR0W2h97V30ODnQ4aL/W8YQ5OjC0X707oqIDQ1fr0S8GXebowNB0HSJoziykgS7qE5IBHRia4zo00BzXIYLmuA4R9EKADgXNb86KoKloHTR9tAaaPloFTR+tgaaPFkHTR4ugFwJ0KGj6aBE0Fa2Dpo/WQHOmexU0Z7rXQHOmexE0Z7oXQfMWHOgrJ0po1jpE0Kx1iKAXAnQ4aH5zVgLN6UFE0HQdImh+WUgFza+/aaDpOoC+RoAWBWhRgBYFaFGAFgVoUYAWBWhRgBYFaFGAFgVoUYAWBWhRgBYFaFGAFgVoUYAWBWhRgBYFaFGAFgVoUYAWBWhRgBYFaFGAFgVoUTYImlwvQIsCtChAi7ISNFlPLoMmaw/QogAtCtCiAC0K0KIALQrQogAtihD6pNe79/T1z71PXrqtf78zFyffPLz39NXD3seP7dYf5h7deJYk0LiU0J+Wx4fHB+XxQbV1WL7+88SoH/zz0tw0W8f2bt14liTQuJTQxvjw98flq2/dlqkcUy8H5qap8t6h2XJ368azJIHGpYauKtqP/MTW9smBwf8tHugyzLjU0NUc7cjtRH3ytb3o9b4/iAY60Lga7jrMzxBl1j8uoC/MjYO+PQFaFKBFAVqUiKDzpP3888nZ7enuZOHaZTZI0nOPuDCX7tQnJujOSjjz39x+WYBelrxjyrV99N5nrdE4Saz60fv9uWtT8q0fUw/ttqe7v3bLctw1t+zjqkeZTLeT1shAu6ex39jc9ZcNJipoW4XTncxeFftG6ujuaO662MuKvoeuts2e3cnsUWaLd5hO3aOqneW443aaO8zTnl42+NPFB23/x5uS3MrOGOc5K2hPuzv5JZt+YAva1OvUPaqsJw37XO5ptm2dV5cNJkrovGXLdyXovGNuV6f4Ogf9zD2NQ07ry8YSJ3SnzM9X9EVTx6S4f39UmulmNkhPoa1u3j7afeaeZmz+FYbd6rLBny4u6KJvfCb2a8PvzM/A1bV9AXww92L4IHV13XG33Iumh65fDJ+7pymH7tQFw9MTGDSTuKDfFgtZt3cedVMSE/RbSs5+PX7Xv2Fx26JxrScRQd/sAC0K0KIALQrQovwHmuXy4fqTEKwAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-34"  />
<p class="caption">plot of chunk unnamed-chunk-34</p>
</div>
<p>We now make the silhouette plot:</p>
<pre><code class="language-r"># pdf(&quot;Spam_kNN_silhouettes.pdf&quot;, width=5.0, height=4.6)
silplot(vcr.obj, classCols = cols, 
        main = &quot;Silhouette plot of kNN on spam data&quot;)      
</code></pre>
<pre><code>##  classNumber classLabel classSize classAveSi
##            1    nonspam      2788       0.81
##            2       spam      1813       0.68
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-35"  />
<p class="caption">plot of chunk unnamed-chunk-35</p>
</div>
<pre><code class="language-r"># dev.off()
</code></pre>
<p>Now we build the class maps. First for the nonspam messages:</p>
<pre><code class="language-r"># To identify the points that stand out:
# classmap(vcr.obj, 1, classCols = cols, identify = T)
# Press &quot;Esc&quot; to get out.
#
# Class map in paper:
# pdf(&quot;Spamdata_classmap_ham.pdf&quot;)
par(mar = c(3.5, 4.3, 2.0, 0.2))
coords &lt;- classmap(vcr.obj, 1, classCols = cols,
                   main = &quot;predictions of non-spam mails&quot;,
                   cex = 1.5, cex.lab = 1.5, cex.axis = 1.5,
                   cex.main = 1.5, maxfactor = 1.03)
# From identify = TRUE above we can mark points:
indstomark &lt;- c(202, 1434, 1596, 2651, 1576, 1804)
labs  &lt;- letters[1:length(indstomark)]
xvals &lt;- coords[indstomark, 1] +
  c(0, 0.125, 0.125, 0.125, 0.125,0.0625) # visual finetuning
yvals &lt;- coords[indstomark, 2] +  
  c(-0.03, 0, 0, 0, 0, 0.03)
text(x = xvals, y = yvals, labels = labs, cex = 1.5)
legend(&quot;topleft&quot;, fill = cols,
       legend = c(&quot;ham&quot;, &quot;spam&quot;), cex = 1,
       ncol = 1, bg = &quot;white&quot;)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAEgCAMAAADi9tZbAAABiVBMVEUAAAAAADAAADUAADoAAFUAAGYAKAAAMDAAMFUAOjoAOmYAOpAAVZYAZDUAZM0AZpAAZrYAgF8AgO4AmYYAsqoAss0Asu4wAAAwMFUwd7U6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6Zjo6ZmY6ZpA6ZrY6kLY6kNtVAABVMABVlrVVltNmAABmADpmAGZmOgBmOjpmOmZmZgBmZjpmZmZmZpBmkGZmkJBmkLZmkNtmtpBmtttmtv93MAB3lrV3tdOQAACQOgCQOjqQZgCQZjqQZmaQZpCQkDqQkGaQkLaQtmaQtpCQtraQttuQ27aQ29uQ2/+WVQCWVTCWtbWWtdOW07WW09O1dzC1lne109O2ZgC2Zjq2kDq2kGa2kJC2kLa2tpC2tra2ttu229u22/+2/7a2/9u2///TllXTtXfTtZbT05bT07XT09PbAADbkDrbkGbbtmbbtpDbtrbb25Db27bb29vb2//b/7bb/9vb////AAD/tmb/tpD/25D/27b/29v//7b//9v///9ZKjg5AAAACXBIWXMAAAsSAAALEgHS3X78AAAWQklEQVR4nO2djX/ctnnH0d7URlLaKOuqrGxcZ35Rk10iZ3E2uVbaXmL33Zv33p2dLbGVKE2nqXIatT1dTz7yLx9eiReCJECCBHGH3+cjiUeCD597viIIgHgBWVRQAr4diLLTMIGdgo3jbAq2Z8K+9OzqcabuNNTjBIA7zrxrIOx2M98VhQMM72v2pecA6tCde/ZaC2AG+ww1B6OHLT1yoUCBLcfgJsyith6QzQnYOMou7wEwOsDfZrEPtx7zO+zyFjx0J0sn6C7ZnpGd6SOYx10/ynAQfr8PwA208x7cucXJ5Imm6FRKW0ivt0LPZbYEb7Psdwn2BTmzc3YFbZ4lYHSXnVPcy04Q7jDVS1t5AUZ0SDe3Z4sEkA2ae5H44u9HD+1IwKgJdNtMafodipTfSzyRDIyl11sh4rYEb+E9jrXHDgPwN+yQcJKwNz+BA1O9tJYfYHezyzH0Hm5Cz8/hl9g+QmhwKOANB/9DKTB8CP6CyYRn2BSMHhALKNQ3Z3Bz4xiefwftZEEXEglZIk+vt0JScVuyt3ey5T7937iD/5f20G96xcJefgIHpnppLS/AkLcoiHQTfgn0T3pKvg/8f4RfjQIjh/589alY6ICn7VELJCU+tmAZV36ZPJEEjKXXWyGpuC3BW/jn+X/vA/pvNMvy3xxYYS89QQImemkvL8BQoBAKvsnywZydBAyLA6M78R/yTMPHHqGs5sYfaHIxkQSMpddbwVng9iy3JXiLbnySLxMc4m+k4t78BOEZJntpryEAY8+tlsBw0QU/MbKsLbDcluAt/Nk8OJ+YA+MniMV6yUt7+c4S839fIk2WCD8v3n5QniVyYFDPP2BbpVmigEZjhQFjtgRv58g0JmEIjJ+g1MO4l/byXehAMYPfaeuIPIlJ+eIsLyXiQkj6CJW5ygodLNRzZBYmZaEoK3TkgLVWSCpuS/AW7zwDNsDYCRyY6qW1fBfrcdZAH2LoS8wTbbEeR10t1vOWDxRqVqreka+DjWqBaa2QVNxWoRJi8QzjJxSK9YGVEvdghZLWSklejvN1XIXFFeebasWZ1IvVijPKX4RQpx/CnZsHvPKbJ9ID01uh5zJbgrfYtTvIlmmhIz9BrDgrXtrKW6EjEA3O2wisWoPzNgKr1uC8jcCqNThvh/l6JapUEVhgisACUwQWmCKwwBSBBaYILDBFYIEpAgtMwwIGVk0dhMi9yRZy4M2gvlAE1osJd4rAOjbhOhoRmIWJi4sL/Jttsb3khyS4KDtZNkKONXgiRWDGJi5UKXszaX/J9YUkAMANa2QRmLEJ58DwVgSmyBmwAi+aP+r3l1xfSALolqWDKwvMYb3FX51Lp/bfp/D93JtsId9ZoiKeJN5hevkGplz//1Av1nF8hpWLe9M4V3FYrKfj8Q6JPxexlFiUAGyXSnBw8apBh3R3XyidbByhbuS0Y2+TJ1IEZmPCgc4/up807wYfgb36dziDQgMkDrP0/Z8BsDdXh1o5bJpi46td2XOioIAle9l8e7Z88yG62dLJDs6vlPvOHbDlGFz7+ZM/jiOwctVniRTP8q3j9P2HGfpB/LQmWl0fXS4hIzQjsHIZApuiUV09ANuZZZf7bWZDWSdgmmI9BbYcH+IssWtgbOxdBFauam8oMPznuw+7ACYL3l1g68G08ejWCIxmibBCu7V/2D2w9lpzYN2biG+cLRWB+TDZQr6BuVYE1osJd4rAOjYRs0RLuXy90u76brROwNgLxgisc5MtVANsjicaWr71Uzyzjb7RPgLrU9XAlm/BSjOawml7Nt84Lmm0j8D6VA0w0qaB2hJRE0embbQf1BcKDdjy1vdkXa1plqvJEmEmOKJopocljfYRWAstx2BTwHWldpbA+kIHfYEJEZU02scssYWWY4mQ8rHSG12xfo5mTUTTYu6gPyWN9hFYC6X3352Vf7T3ZkpKiW++g0uJ+kb7mCU60ZeFaaS16Iy8Ud6nNDHRl4IE9uzt48sxf297ef/2Azy7aL4Ehq03HQJb9ywRCc3LOgUvPaK9xXDXsZ3J6No7iWa9odiW6MOkpHSCZzs/RLVd9HkK9tDD5xA1WxQ7S0RgPkxKQiXDOZ5OHJcQ8R+yrSszRmA+TEpCWE7xKgkR2FBNypqC62O8TAB+hqUTMvf+QLNE1woR2BItpAZvpy1yO81poePgwyEWOlxoKfTtDhFYlj1HKwOcs0+X9753MEM9/rTFegfi4/XYCDBx5B7eS7cuCgPFmkaDNsjgpjQQPDCkQsU51S7IRL3JIywOoLyQ495A4jDz4pZwfUvRwX5566fQwNbIXvXF3JtUpFScTbzxBqyZ6HBaZmgMYL6/dSR8H5fqu+Is6HnxJiPeFKMqh70hrzo1/YZAscOX1gwRmFpx5hKL9XLTvD9gjaKhATZLH+N/0ACBKRVnQekXT8qK9XkAxWgKvIb1DNMAwwOkj4MFJlSczbwJC1jxGYZ2nqI8MUBgSsWZ6Pz8XJ849yZ/opCIsm3hOZNHOxODLm30VazPp4QgFwJhA1MqzmSVNVCy0qrvWm/LehjZwvWwYLPETKk4o5VX3/3Vxx/dTnSrhfsG5kJ4PaRwCx2qpvksDaea+RRWA9g1lIfgR3aQwJ6Rvm5Caz1RR631reTi+svxHqw4vxZwxZkKrw66BsC6tNeNSUmw4vxPsO58OaZt86ufJYoKEBi6j6Z4dXnS0oE6795e6UKHqECBzeFdlWeAK1ms78teNyYlobZENLhEemLVV5w9qXD9JnPuVdlrr85DBPPCT8ajgw+M3q8MDFizWS3L7blQ9yE6e/UYdUbcqur92Z83VtdvNm9suT0X6ilE59oXzAUNC1jDmZlL7TmR7xDJGpg3awdMGtBXN5ivc2+sFYH59cZA8RlmKd/exFKipYblTbaW9bDs+f/ACtjy7QcmaVVvSrsylR0Q1hEwMdO1QgQ2T8jIB03H7DpvxFf7RgfE7hsGZuqu314BAsOjHzLU6Gvf0hGB9WNSEmtDrJ9BoOCNLviVBy4udMRKzdRd34ECBIYaf9HfBndYBNaTSVmnYHT944/v6QYX1XkTs8R+TCo6w++/dIOLivINzLWCBIb6uJ0bztUfi/U+TLaQb29ilmgpn97gxWQd24zAOlM3D7oIrDNFYI3kzRtauIxZIpFhBwHuzUVBwt6scET+zMcZ0ZPk9WTJB2U8kxmwurb7wrTtQQK7fB+AjU/evGOSlnhTxNVMmabxowp1DbC6t2N0zgkAkrzHUYjAFsno75ONTycWLR1DBVaTBNBBmPmQ9DCBTdGA9I1ji7ZEV7xqM8/i8apo1PXwYLx+DG/CMzqCIEBgCBb7qfBCnEXAE7C6b2IKLEl4ipUFJnvjjJdNlljvmymwcdDA0gnJEnVzt5V54w+Yi2eYcIOFCIwUOkY/SzSDi8q90QbfvlgvnpBfg3zQTlNQA8y0lFj8Pg7VfbF+sY++iVHXetfeCPeOExnVw9Ab2wWd9ydIYFn2/MunhjVnt95IuV1vmmNspBITILDlT55apPYNzMn1z5L8dW2IwMYAXH9qmtp3lhjbEqG+vAeMmUVgPkwW9ewWZHbDxwhMywdYBMaUPqpdigrJ98ueCAwrfQZL9psm3aZ8A3OtEIERWgdm3aYiMB8mJcFS4ujA9P2ld2AxS4T1sCOL1BGYD5MtNCxv2is0YMtbVz+51WiM8+6usJd90JXRyTGWQjqtSsYJ22ldgO1iZfIHXS14V5ByWpVKE8Ys0VIRmA+TkvKVZT98zbilgyMQPuhacne1qr1KecIILB95ubDoIhCB9WuSazkWloky6iJwgkXieSJ/ILxOJImclNOqVJoQGJxso9CAZX++/U4yunYbyaj27BuYawUHDBcUDbJCpvw/XAon+6Di4sdYCmMKveAKEpidXGdJ1gF2ba+DELk3qUiat77OG8cBsw6wa3vuw9k5MHne+jpvHAfMtwIEps5bz6RZni+LwAzURz1MnLde2K3zxneAXdtzH9A+gAnz1qf3cRmflPbfLa7Q5zhg1gF2bc99QHvIEsV566WqtGbtFccBsw6wa3vuA9p5oUOZtx4CRJ07YpbYVN0X69V563+X3JhFYI3VU8VZHJa+2N86Gigw1woXmKT00egHqw7sf9978SRQYM/eKb5xPkv0/Uqlxt8WOslbg092hdZGdgT9ph/o9eiW/h8Glo8qPso72d9wgaGWjmIXgcv7xTJ9RoG1xtUALtnSAgMAHuKMlI/yTn4wWGDpJF+Sz0C+gWnvL3wMlHyUd9K/r4AX/jVUYBWD0TWtU6B/XqLKeeWIlI/KTvz7G6iO+cLrgQJjc/4WJaLM69KegekeTvSYMbC/Al8FJ5+/BwIFBivOO/pm+vSLJ/qmqb4p8S0nwL4FvgkP/uaVQIEt0dCwkXG/xOEBs36GvRx2oWOp60havgYm+f5uIDgq1tuWEgMHVlD1KrOagPUpJ/WwV74D//72+y+eBAksnWxLWeEiAZvvlq/j7BiAD/32+195A95goRY61GJ9zUrpvqPtQp8FXayHXG4KhUGBn66G5huYm+v/+nXwwr+H+gxL798SS4lrAUyw5z6gfZcSjbJEXtbTBEG3k5f2ahL2rACBqYKFjtHt6kKHUkKXpdsp1aeqEvauUIGJry/ri/UegcUsMdPOql1ZcS5UgkXpdmrTl/CuC3AbOjp77sPZOTC7WbWL8Y/AlBC5NynLblbtIgAlBDFLdG9SkuUkzTzUEVhJiNyblNQAWCzWV4bIvUlJlrNq+46wYwUIzHJWbd8Bdm3PfTy7L9ZbzartOGDWAXZtz304+6g4W8yq7ThgvhUgMMuJVXxH2LECBGY5sYrvALu25z6gg5xYxZvWHVjTiVW8ae2BNZ5YxZMiMEtFYPUhcm+Si79utulIukKKwAJTaMCs5RvYumeJ1orA6kPk3qSikCYHc60QgcXJwdzK1+RgJd74DrBre+4D6mlysDJvHAfMOsCu7bkPaM+Tg9V5Q76n2nGqWpp+U3xT3C1+PmHJTsS+BIAMG2Kjd7UMxCOagUifvw7AX/9buMCUycHqvLHH5Ugs4rtoYB7+pUUmDefTD/VD+sqPggWmTg5W441vYGiTjn9Vh8XyBPJ4Z2kw7be/Bt44Ofk1HuAcKLDC5GCV3vjiRUfMElJEOmLSkHTdcHUyIv3kP//iP8IFhnVe/XJlANM+uAH2MpDyxNCApfIERal+viLRG79ZInkKMQ5rCEwpadQXPIJ/hn1LKTa6j2nXXQQ2hfb6K7VLAzcCVlWsl3bv1hfr25YSvw3AD09OPn8v0GeY9HrF5BWLBEwOlbhPd1wv85R51NvVwz4jWeJ36A73MR1ea714p6iRZ5OkmHIwT0kDbJqwXL+BFeevv8HsdRAi9yZbaAWAyfY6CJF7k6LQqttb5gsD+84S1x7YHIBrt3Sjz0sUgdWHyL1JrhQPlJ1r5nco84aHufjtxX3mEOyKHBZpjey5j2kP9TCzdl/ijeOA+VYEFpgisK4D7Nqe+5hGYFKAXdtzH9MIrEuFB6xy8SmNN74j7FihAWPLu2HVvVrB3vgOsGt77mM6vKYpn4rALEUC5m9GlAjMUrzx13HkTAPs2l4HIXJvsoUisPoQuTfZQqDpvHkDVQQWmNYBWMwSa0Lk3mQLRWD1IXJvsoV8F+tda1WA1a1utDJaBWABrm7Uwp77+HlYaGDAqxs5uf6/APDif1F77gPYN7Bhr27k4vqoK+mLzJ77APYMbA0Wy/kM/C235z6CEZgoB9f/Z3iD0Z71qwBs4FmiA60aMIPVjQLXamWJRsX6XW8Ckk7oOJb8c75bOSInWzFgSFarG/UKDA8OY6PEUPBzinRjl4wIY5/FvaA4sGxVgJXKNzAy/JINwSTkCDu2gf/kgy+FvYCnXlVgz4t5IvDNC0ec/QV8a1cery6tZS/z2n0Z/CVYSWBisR6sqtyHzR+w9IsnhY5vvrNE5T6Kd1id/AOLzzCdal6v9AdIVSwlFjXs1yuS1B2G9TDRnvv4xdcrXWoFgK18W6Kk8IGtfmu9bM99BAcGbNXkPoLDyhKp6pzSHy87y+Ir1iatt9V1QIf1eoUqAvNnv6DKYj1VBObPvlalFWeqCMyf/UaKwPzZb6QIzJ/9RorA/NmPcqwILDBFYIEpAgtMEVhgisAC0/CAXe4DcFUzr7Oyf4obuPaK6bSp0WTRJms6mljQbfWnwQEjM8AV37wo+9NJJTAl9RzojZr7wS3otnrU4ICdgpuz9HGRhLJ/kVSuqSmnXo5Hd+H9kBhPFl1hQbfVp4YGLJ2gheHI76r988q51ZXUiwTH/dTiZii1oNsytupAQwO2HON/2KkaBXX/6cYvkvJF5JTULLTmE+iXW9BtGVt1oKEBK4uCup+UOcrWGlZSw8zrAcq8LEJbakG3ZWzVgQIFlk5QsM7KFtZUrdDVv5sDEyzotnpUoMCopiXBKqQ+S8Dork3mVWFBt9WfhgZsOcaB0jzDdPvLgqVPXTBq7Qf/qNvqRUMDZlhKpDdAWbC0VpZjk5WJzSzotvrR0IDB0gSs/zwq1sPk/fAZdjeD1aSyOpCaeuMou5yUt4tYWNBt9anBAatv6ZiTJZMqn/dKalI8sLoVSi3otnrU4IDhNjzdGnH5fhzAbAE/vla+lJySGhUPbti3JWot6Lb60/CARVUqAgtMEVhgisACUwQWmCKwwDRQYI8A2GlTXrY9v9i04jK5Sw0TGKoWt3mRa31+BNZO87IXXT2dX6cITNaUNAqdXQFgdAeFZ+cUbDydbH90BX8WejSl92CSu+JGfv6n+KyjvMVikeydJfD0eSL0dEJtFQeTHUyAvOvHr5qZ/VS4JkuPXnMTYMy/Ei+60YCBnbKXyulkMwHbf5rkL5kXCW1IpH2nDvkGP/9TfNZsztIukmtwc/TLRMgu6SUIMNKvB92cqv38fp3n+yEwwT+tF91okMBw1HBjOIwdiiZqEYe/d2Z4KDtuqsfdlRbJjRlOkm+I59Oz7iIwiAfcOkM94xYJzdDwS/7LCQUGb+QMv7Hh9vk1seCBh9DEHk3O/CvzohMNFxjU+Uf3ExxNlFmR3yjHEjsubf7DU7Sdb/DzSXoavinqM7ND317lT6A5fjVC/ifQLQNxyPb5NTNylfxtC7ZA/SvzohMNGBjJmOi/P3+luENfreC8CffFuX6U8Y38fJKe9l+c005OJPZTCoy8sE7pMwzzQGdy+/yaWHlnSJqc+lfmRScaLrDlGFz7+ZM/jiuB4d7S+K1VvsHOtweGfqF32GbAuH9lXnSi4QIj0cnzKwGY0uv3yw/oYz7fkIDxLLEATMkSIcB/RMe5/QIwIUvk/pV50YmGDAw+72H5Gj3eZWCkj9slfL7MwU14YzwePcw3+PksPS90FIDJhQ4U/dso2Ny+AgwXOhZj4hH3r8yLTjRcYKxIXQTG8qw9lgYlkV7Xc2CZUKwvAJOL9Zguzs4E+xIweuCQlhKBenHFi040XGCkxvtgyv/PefBQ/4DNvKaK3tLnG/n5rCy44BXnAjBccf5B/pjMC/DMvgqM9ESk+3P/yrzoRMME1qtoF8RAtNbAFslL8Jkz7bjh0a3WGlgfzxzXWmtgfTxzXGu9gQWo/wfGAymIUcbQxAAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-36"  />
<p class="caption">plot of chunk unnamed-chunk-36</p>
</div>
<pre><code class="language-r"># dev.off()
par(oldpar)
# To interpret the marked points:
# markInds = which(y == &quot;nonspam&quot;)[indstomark]
# X[markInds, ] 
</code></pre>
<p>Now for the spam messages:</p>
<pre><code class="language-r">#
# To identify the points that stand out:
# classmap(vcr.obj, 2, classCols = cols, identify = TRUE)
# Press &quot;Esc&quot; to get out.
#
# Class map in paper:
# pdf(&quot;Spamdata_classmap_spam.pdf&quot;)
par(mar = c(3.5, 4.3, 2.0, 0.2))
coords &lt;- classmap(vcr.obj, 2, classCols = cols,
                   main = &quot;predictions of spam mails&quot;,
                   cex = 1.5, cex.lab = 1.5, cex.axis = 1.5,
                   cex.main = 1.5, maxfactor = 1.03)
indstomark &lt;- c(1306, 1294, 1754, 177)
labs  &lt;- letters[6 + (1:length(indstomark))]
xvals &lt;- coords[indstomark, 1] + c(0.1, 0.1, 0.1, 0.1)
yvals &lt;- coords[indstomark, 2] + c(-0.03, 0, 0, 0.03)
text(x = xvals, y = yvals, labels = labs, cex = 1.5)
legend(&quot;topleft&quot;, fill = cols,
       legend = c(&quot;ham&quot;, &quot;spam&quot;), cex = 1,
       ncol = 1, bg = &quot;white&quot;)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-37"  />
<p class="caption">plot of chunk unnamed-chunk-37</p>
</div>
<pre><code class="language-r"># dev.off()
par(oldpar)
</code></pre>
<hr />
</div>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>
</body>
</html>
